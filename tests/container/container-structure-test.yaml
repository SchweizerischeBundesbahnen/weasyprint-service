---
schemaVersion: 2.0.0
commandTests:
  - name: Python installation - check that the python binary is in the correct location
    command: which
    args: [python]
    expectedOutput: [/usr/local/bin/python]
  - name: Python version is correct
    command: python
    args: [--version]
    expectedOutput: [Python 3.13.*]
  - name: uv version is correct
    command: uv
    args: [--version]
    expectedOutput: [uv 0.*.*]
  - name: Weasyprint version is correct
    command: uv
    args: [run, weasyprint, --version]
    expectedOutput: [66.0]
  - name: Chromium version is correct
    command: /root/.cache/ms-playwright/chromium-1187/chrome-linux/chrome
    args: [--version]
    expectedOutput: [Chromium 140.*.*.*]
  - name: Tox should not be installed
    command: uv
    args: [run, --no-sync, tox, --version]
    exitCode: 2
  - name: Pytest should not be installed
    command: uv
    args: [run, --no-sync, pytest, --version]
    exitCode: 2
  - name: Log directory exists
    command: test
    args: [-d, /opt/weasyprint/logs]
    exitCode: 0
  - name: Log directory is writable
    command: touch
    args: [/opt/weasyprint/logs/test.log]
    exitCode: 0
  - name: Python logging module is available
    command: python
    args: [-c, import logging; logging.basicConfig(); logging.info('test')]
    exitCode: 0
fileExistenceTests:
  - name: Log directory
    path: /opt/weasyprint/logs
    shouldExist: true
    permissions: drwxrwxrwx
    uid: 0
    gid: 0
  - name: Dashboard HTML resource
    path: /opt/weasyprint/app/resources/dashboard.html
    shouldExist: true
  - name: Dashboard note.png resource
    path: /opt/weasyprint/app/resources/note.png
    shouldExist: true
  - name: Chart.js library for dashboard
    path: /opt/weasyprint/app/static/chart.umd.min.js
    shouldExist: true
